# Config file in HOCON format.  See following for more information:
# https://www.playframework.com/documentation/latest/Configuration

portcode = "test"

akka {
  log-dead-letters = 0,
  warn-about-java-serializer-usage = false
  jvm-exit-on-fatal-error = true
  actor {
    serializers {
      protobuf = "actors.serializers.ProtoBufSerializer"
    }
    serialization-bindings {
      "server.protobuf.messages.CrunchState.CrunchDiffMessage" = protobuf
      "server.protobuf.messages.FlightsMessage.FlightsDiffMessage" = protobuf
      "server.protobuf.messages.CrunchState.CrunchStateSnapshotMessage" = protobuf
      "server.protobuf.messages.ShiftMessage.ShiftStateSnapshotMessage" = protobuf
      "server.protobuf.messages.FixedPointMessage.FixedPointsStateSnapshotMessage" = protobuf
      "server.protobuf.messages.StaffMovementMessages.StaffMovementsStateSnapshotMessage" = protobuf
      "server.protobuf.messages.FlightsMessage.FlightStateSnapshotMessage" = protobuf
      "server.protobuf.messages.FlightsMessage.FeedStatusMessage" = protobuf
      "server.protobuf.messages.FlightsMessage.FeedStatusesMessage" = protobuf
      "server.protobuf.messages.VoyageManifest.VoyageManifestStateSnapshotMessage" = protobuf
      "server.protobuf.messages.VoyageManifest.VoyageManifestLatestFileNameMessage" = protobuf
      "server.protobuf.messages.VoyageManifest.VoyageManifestsMessage" = protobuf
      "server.protobuf.messages.VoyageManifest.VoyageManifestMessage" = protobuf
      "server.protobuf.messages.Alert.AlertSnapshotMessage" = protobuf
      "server.protobuf.messages.Alert.Alert" = protobuf
    }
  }
  stream.materializer {
    initial-input-buffer-size = 1
    max-input-buffer-size = 1
  }
  extensions = [akka.persistence.Persistence]
}

aggregated-db {
  connectionPool = disabled
  driver = "org.h2.Driver"
  url = "jdbc:h2:mem:drt;DB_CLOSE_DELAY=-1"
  keepAliveConnection = true
}

persistence {
  snapshot-interval {
    voyage-manifest: ${?SNAPSHOT_INTERVAL_VM}
  }
  snapshot-megabytes {
    base-arrivals: 1
    forecast-arrivals: 5
    live-arrivals: 2
    forecast-portstate: 10
    live-portstate: 25
    voyage-manifest: 100
  }
}
